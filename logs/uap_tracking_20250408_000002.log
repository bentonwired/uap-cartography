2025-04-08 00:00:02,876 INFO fetch_uap_data - Reddit API initialized successfully.
2025-04-08 00:00:02,891 INFO fetch_uap_data - Script started.
2025-04-08 00:00:02,891 INFO fetch_uap_data - Fetching UAP sightings from Reddit...
2025-04-08 00:00:02,892 INFO fetch_uap_data - Fetching posts from subreddit: UFOs
2025-04-08 00:00:05,055 DEBUG fetch_uap_data - Parsing event date from: '9:15pm 3/19/25'
2025-04-08 00:00:06,349 DEBUG fetch_uap_data - Dateparser failed, falling back to custom extraction logic.
2025-04-08 00:00:06,350 DEBUG fetch_uap_data - Extracted two-digit year from mm/dd/yy: 2025
2025-04-08 00:00:06,350 DEBUG fetch_uap_data - Extracted numeric month: 9
2025-04-08 00:00:06,350 DEBUG fetch_uap_data - Extracted day: 9
2025-04-08 00:00:06,350 DEBUG fetch_uap_data - Time not found in '9:15pm 3/19/25'
2025-04-08 00:00:06,350 DEBUG fetch_uap_data - Constructed datetime from fallback: 2025-09-09 00:00:00+00:00
2025-04-08 00:00:07,028 DEBUG fetch_uap_data - Geocoded location 'Downtown Chicago' to (41.878963, -87.642124).
2025-04-08 00:00:07,028 DEBUG fetch_uap_data - Skipping post 1ju3u4n because event date (2025-09-09 00:00:00+00:00) is outside the 7-day window from report date (2025-04-08 03:07:51+00:00). Time difference: 153 days, 20:52:09
2025-04-08 00:00:07,028 DEBUG fetch_uap_data - Parsing event date from: '7:45pm'
2025-04-08 00:00:07,102 DEBUG fetch_uap_data - Parsed datetime using dateparser: 2025-04-08 19:45:00+00:00
2025-04-08 00:00:07,756 DEBUG fetch_uap_data - Geocoded location 'Oahu Hawaii' to (21.483436, -158.036484).
2025-04-08 00:00:07,756 DEBUG fetch_uap_data - Added post with ID 1ju3ck4
2025-04-08 00:00:08,757 DEBUG fetch_uap_data - Skipping post 1ju2dvy as it has no video content.
2025-04-08 00:00:08,757 DEBUG fetch_uap_data - Parsing event date from: '4:05pm 10/30/24'
2025-04-08 00:00:08,826 DEBUG fetch_uap_data - Dateparser failed, falling back to custom extraction logic.
2025-04-08 00:00:08,827 DEBUG fetch_uap_data - Extracted two-digit year from mm/dd/yy: 2024
2025-04-08 00:00:08,827 DEBUG fetch_uap_data - Extracted numeric month: 4
2025-04-08 00:00:08,827 DEBUG fetch_uap_data - Extracted day: 4
2025-04-08 00:00:08,827 DEBUG fetch_uap_data - Time not found in '4:05pm 10/30/24'
2025-04-08 00:00:08,827 DEBUG fetch_uap_data - Constructed datetime from fallback: 2024-04-04 00:00:00+00:00
2025-04-08 00:00:09,227 DEBUG fetch_uap_data - Geocoded location 'Downtown Chicago' to (41.878963, -87.642124).
2025-04-08 00:00:09,227 DEBUG fetch_uap_data - Skipping post 1ju1xhe because event date (2024-04-04 00:00:00+00:00) is outside the 7-day window from report date (2025-04-08 01:28:50+00:00). Time difference: 369 days, 1:28:50
2025-04-08 00:00:09,227 DEBUG fetch_uap_data - Parsing event date from: '8:05pm'
2025-04-08 00:00:09,228 DEBUG fetch_uap_data - Parsed datetime using dateparser: 2025-04-08 20:05:00+00:00
2025-04-08 00:00:10,169 DEBUG fetch_uap_data - Geocoded location 'Henderson Nevada' to (36.031984, -114.982249).
2025-04-08 00:00:10,289 DEBUG fetch_uap_data - Added post with ID 1jtzyif
2025-04-08 00:00:11,290 DEBUG fetch_uap_data - Parsing event date from: '1/19/2025 at 12 AM'
2025-04-08 00:00:11,301 DEBUG fetch_uap_data - Dateparser failed, falling back to custom extraction logic.
2025-04-08 00:00:11,301 DEBUG fetch_uap_data - Extracted 4-digit year: 2025
2025-04-08 00:00:11,301 DEBUG fetch_uap_data - Extracted numeric month: 1
2025-04-08 00:00:11,301 DEBUG fetch_uap_data - Extracted day: 1
2025-04-08 00:00:11,302 DEBUG fetch_uap_data - Time not found in '1/19/2025 at 12 AM'
2025-04-08 00:00:11,302 DEBUG fetch_uap_data - Constructed datetime from fallback: 2025-01-01 00:00:00+00:00
2025-04-08 00:00:11,527 DEBUG fetch_uap_data - Geocoded location 'Joshua Tree National Park, CA' to (33.897067, -115.951116).
2025-04-08 00:00:11,527 DEBUG fetch_uap_data - Skipping post 1jtzyah because event date (2025-01-01 00:00:00+00:00) is outside the 7-day window from report date (2025-04-07 23:49:30+00:00). Time difference: 96 days, 23:49:30
2025-04-08 00:00:11,527 DEBUG fetch_uap_data - Parsing event date from: '11:30 PM - April 24th, 2023'
2025-04-08 00:00:11,528 DEBUG fetch_uap_data - Parsed datetime using dateparser: 2023-04-24 23:30:00+00:00
2025-04-08 00:00:13,598 DEBUG fetch_uap_data - Geocoded location 'Tampa, FL' to (27.947760, -82.458444).
2025-04-08 00:00:13,598 DEBUG fetch_uap_data - Skipping post 1jtz4hf because event date (2023-04-24 23:30:00+00:00) is outside the 7-day window from report date (2025-04-07 23:10:23+00:00). Time difference: 713 days, 23:40:23
2025-04-08 00:00:13,598 INFO fetch_uap_data - Total raw posts iterated: 100
2025-04-08 00:00:13,599 INFO fetch_uap_data - Fetched 2 sightings. Inserting into database...
2025-04-08 00:00:13,626 DEBUG fetch_uap_data - Connected to the PostgreSQL database successfully.
2025-04-08 00:00:13,629 DEBUG fetch_uap_data - Primary key sequence updated.
2025-04-08 00:00:13,629 INFO fetch_uap_data - Inserting 2 records into the database.
2025-04-08 00:00:13,631 INFO fetch_uap_data - Total records processed: 2
2025-04-08 00:00:13,631 INFO fetch_uap_data - Records inserted: 1
2025-04-08 00:00:13,631 INFO fetch_uap_data - Skipped duplicates: 1
2025-04-08 00:00:13,637 DEBUG fetch_uap_data - Primary key sequence updated.
2025-04-08 00:00:13,637 DEBUG fetch_uap_data - Database connection closed.
2025-04-08 00:00:14,088 INFO fetch_uap_data - Fetched 23 flight records for location (21.483436, -158.036484)
2025-04-08 00:00:14,117 DEBUG fetch_uap_data - Connected to the PostgreSQL database successfully.
2025-04-08 00:00:14,119 ERROR fetch_uap_data - Error inserting flight data: null value in column "flight_id" of relation "flight_data" violates not-null constraint
DETAIL:  Failing row contains (null, null, null, null, null, null, https://www.reddit.com/r/UFOs/comments/1ju3ck4/unknown_item_hawa..., null, ~2875dd, tisb_trackfile, null, null, null, 800, 98, null, null, null, null, null, null, null, 140.79, null, null, null, null, null, null, null, null, 21.423431, -158.215866, 0, 0, 9.11, 0, 0, null, ["altitude", "gs", "track", "geom_rate", "lat", "lon", "nic", "r..., 46, 9, 0, null, null).

2025-04-08 00:00:17,496 INFO fetch_uap_data - Email notification sent successfully.
2025-04-08 00:00:17,496 INFO fetch_uap_data - Script finished. Total runtime: 0:00:14.605020
